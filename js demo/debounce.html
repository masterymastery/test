<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>promise</title>
</head>
<!-- 防抖：高频事件发生时，在事件回调完成之前再次触发，以最后一次触发事件为准
     只要触发事件，就会执行
     节流是回调执行之前触发，事件不会执行
-->

<body style="margin:0px;">
    
    <input id="inp" type="text"></input>
    <button id='btn'>aa</button>
    <script>
        function debounce(fn) {
            //首次进来this是window，因为不是input调用的，属于window调用
            let timeout = null; // 创建一个标记用来存放定时器的返回值,只在绑定的时候执行一次
            return function () {
                //timeout = null;
                clearTimeout(timeout); // 每当用户输入的时候把前一个 setTimeout clear 掉
                //每一次触发事件都会清除当前timeout并重新创建一个,每次都会重新执行setTimeout
                //保证输入字符后的 timeout 间隔内如果还有字符输入的话，就不会执行 fn 函数
                timeout = setTimeout(() => { 
                    //this指向input，因为是input触发的这个事件
                    fn.apply(this, arguments);
                    //fn();//不绑定this，this即是window
                  //  console.log('防抖成功');
                }, 10000);
            };
        }

        function sayHi() {
            console.log(this + '防抖成功');
        }

        var inp = document.getElementById('inp');
        inp.addEventListener('input', debounce(sayHi)); // 防抖    
       // inp.addEventListener('click', sayHi, true);

     //  var a = document.getElementById('btn');
     //   a.addEventListener('click', sayHi); // 防抖
    </script>
</body>

</html>